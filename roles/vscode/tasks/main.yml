---
- name: Install MS repo key
  apt_key:
    url: https://packages.microsoft.com/keys/microsoft.asc
    id: BE1229CF
    state: present
  become: yes
  when: ansible_os_family == "Debian"

- name: Add Visual Studio code repository
  apt_repository:
    repo: 'deb [arch=amd64] https://packages.microsoft.com/repos/vscode stable main'
    filename: vscode
    state: present
    update_cache: yes
  become: yes
  when: ansible_os_family == "Debian"

- name: Install Visual Studio code
  package:
    name:
    - code
    state: present
  become: yes
  notify: Installing vscode extensions
  when: ansible_os_family == "Debian"

- name: Install Visual Studio code
  shell: |
    pikaur -Syu --noconfirm visual-studio-code-bin
  notify: Installing vscode extensions
  when: ansible_os_family == "Archlinux"

- name: Pylint for vscode
  pip:
    name: pylint

- name: Setup VSCode i3 configuration.
  blockinfile:
    path: '{{ i3_config_location }}'
    marker: '# {mark} Adding VSCode config'
    block: |
      bindsym $mod+c exec code